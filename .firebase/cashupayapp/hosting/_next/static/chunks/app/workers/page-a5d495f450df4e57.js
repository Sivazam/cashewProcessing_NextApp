(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[901],{57918:function(e,s,a){Promise.resolve().then(a.bind(a,96564))},96564:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return S}});var t=a(57437),r=a(2265),l=a(79303),n=a(91393),d=a(82666),i=a(93023),c=a(51908),o=a(24033),x=a(16691),m=a.n(x),h=a(86110),u=a(87516),p=a(67972),j=a(68291),g=a(76637),f=a(34822),y=a(28692),N=a(4737),v=a(93330),w=a(11552),b=a(77094),k=a(71424);function C(e){let{worker:s}=e,a=(0,o.useRouter)(),{deleteWorker:n,updateWorker:d}=(0,v.Es)(),{settings:c}=(0,v.F2)(),{payments:x,addPayment:C}=(0,v.az)(),[E,A]=(0,r.useState)(!1),[T,S]=(0,r.useState)(!1),[I,O]=(0,r.useState)(!1),[Z,_]=(0,r.useState)("advance"),[z,P]=(0,r.useState)(!1),D=x.filter(e=>e.workerId===s.id&&"advance"===e.type).reduce((e,s)=>e+(s.amount||0),0),H=x.filter(e=>e.workerId===s.id&&"payout"===e.type).reduce((e,s)=>e+(s.amount||0),0),L=(s.totalAmount||0)-D-H,W=e=>{_(e),O(!0)};return(0,t.jsx)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,t.jsxs)(h.Zb,{className:"relative overflow-hidden rounded-xl border border-gray-100 shadow-lg hover:shadow-xl transition-all duration-300",children:[(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"relative w-12 h-12 rounded-full overflow-hidden border-2 border-gray-200 shadow-sm",children:s.avatar?(0,t.jsx)(m(),{src:s.avatar,alt:s.name,fill:!0,className:"object-cover"}):(0,t.jsx)("div",{className:"w-full h-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center text-white text-xl font-bold",children:s.name.charAt(0)})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-bold",children:s.name}),s.phone&&(0,t.jsxs)("p",{className:"text-sm text-gray-500 flex items-center",children:[(0,t.jsx)(p.Z,{className:"h-3 w-3 mr-1"})," ",s.phone]})]})]}),(0,t.jsx)(l.E.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,t.jsxs)(i.z,{onClick:()=>a.push("/workers/".concat(s.id)),className:"rounded-full h-8 px-3 py-1 shadow-md bg-primary text-primary-foreground hover:bg-primary/90 text-sm font-medium",children:[(0,t.jsx)("span",{children:"Details"}),(0,t.jsx)(j.Z,{className:"ml-1 h-3 w-3"})]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-2 mb-3",children:[(0,t.jsxs)("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[(0,t.jsx)("p",{className:"text-xl font-bold text-gray-800",children:s.totalKgsProcessed}),(0,t.jsx)("p",{className:"text-xs text-gray-500 font-medium",children:"kg Processed"})]}),(0,t.jsxs)("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("p",{className:"text-xl font-bold text-gray-800",children:[c.currency," ",s.totalAmount]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 font-medium",children:"Total Earned"})]}),(0,t.jsxs)("div",{className:"text-center p-2 bg-gray-50 rounded-lg relative",children:[(0,t.jsxs)("p",{className:"text-xl font-bold text-gray-800",children:[c.currency," ",D]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 font-medium",children:"Advances"})]}),(0,t.jsxs)("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("p",{className:"text-xl font-bold text-gray-800",children:[c.currency," ",L]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 font-medium",children:"Pending"})]})]}),(0,t.jsx)("div",{className:"bg-blue-50 p-2 rounded-lg mb-3",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("p",{className:"text-xs font-medium text-blue-700",children:"Payouts Made"}),(0,t.jsxs)("p",{className:"text-sm font-bold text-blue-800",children:[c.currency," ",H]})]})})]}),(0,t.jsxs)(h.eW,{className:"flex flex-wrap gap-1 pt-0 pb-3 px-4",children:[(0,t.jsx)(l.E.div,{whileHover:{scale:1.03},whileTap:{scale:.97},className:"flex-1",children:(0,t.jsxs)(i.z,{onClick:()=>S(!0),className:"w-full rounded-lg h-8 shadow-sm bg-green-500 text-white hover:bg-green-600 text-xs font-medium",children:[(0,t.jsx)(g.Z,{className:"mr-1 h-3 w-3"}),(0,t.jsx)("span",{children:"Log Work"})]})}),(0,t.jsx)(l.E.div,{whileHover:{scale:1.03},whileTap:{scale:.97},className:"flex-1",children:(0,t.jsxs)(i.z,{onClick:()=>W("advance"),className:"w-full rounded-lg h-8 shadow-sm bg-blue-500 text-white hover:bg-blue-600 text-xs font-medium",children:[(0,t.jsx)(f.Z,{className:"mr-1 h-3 w-3"}),(0,t.jsx)("span",{children:"Advance"})]})}),(0,t.jsx)(l.E.div,{whileHover:{scale:1.03},whileTap:{scale:.97},className:"flex-1",children:(0,t.jsxs)(i.z,{onClick:()=>W("payout"),className:"w-full rounded-lg h-8 shadow-sm bg-purple-500 text-white hover:bg-purple-600 text-xs font-medium",children:[(0,t.jsx)(y.Z,{className:"mr-1 h-3 w-3"}),(0,t.jsx)("span",{children:"Payout"})]})}),(0,t.jsx)(l.E.div,{whileHover:{scale:1.03},whileTap:{scale:.97},children:(0,t.jsx)(i.z,{onClick:()=>A(!0),className:"rounded-lg h-8 w-8 shadow-sm bg-red-500 text-white hover:bg-red-600 p-0",children:(0,t.jsx)(N.Z,{className:"h-3 w-3"})})})]}),(0,t.jsx)(u.aR,{open:E,onOpenChange:A,children:(0,t.jsxs)(u._T,{className:"rounded-xl",children:[(0,t.jsxs)(u.fY,{children:[(0,t.jsx)(u.f$,{children:"Are you sure?"}),(0,t.jsxs)(u.yT,{children:["This will permanently delete ",s.name," and all associated records. This action cannot be undone."]})]}),(0,t.jsxs)(u.xo,{children:[(0,t.jsx)(u.le,{className:"rounded-lg",children:"Cancel"}),(0,t.jsx)(u.OL,{onClick:()=>{n(s.id),A(!1),k.Am.success("".concat(s.name," has been deleted"))},className:"bg-red-500 hover:bg-red-600 rounded-lg",children:"Delete"})]})]})}),(0,t.jsx)(u.aR,{open:z,onOpenChange:P,children:(0,t.jsxs)(u._T,{className:"rounded-xl",children:[(0,t.jsxs)(u.fY,{children:[(0,t.jsx)(u.f$,{children:"Clear Advance?"}),(0,t.jsxs)(u.yT,{children:["This will clear the advance amount of ",c.currency," ",D," for ",s.name,". Are you sure you want to proceed?"]})]}),(0,t.jsxs)(u.xo,{children:[(0,t.jsx)(u.le,{className:"rounded-lg",children:"Cancel"}),(0,t.jsx)(u.OL,{onClick:()=>{d(s.id,{advanceAmount:0}),C({id:crypto.randomUUID(),firmId:s.firmId,workerId:s.id,type:"clear_advance",amount:s.advanceAmount||0,date:new Date().toISOString().split("T")[0],createdAt:new Date().toISOString()}),P(!1),k.Am.success("Advance cleared for ".concat(s.name))},className:"bg-yellow-500 hover:bg-yellow-600 rounded-lg",children:"Clear Advance"})]})]})}),(0,t.jsx)(w.e,{open:T,onOpenChange:S,workerId:s.id}),(0,t.jsx)(b.o,{open:I,onOpenChange:O,workerId:s.id,defaultType:Z})]})})}var E=a(53464),A=a(9883),T=a(41827);function S(){let[e,s]=(0,r.useState)(""),[a,o]=(0,r.useState)(!1),{workers:x,getWorkersByFirm:m}=(0,v.Es)(),{selectedFirmId:h,firms:u}=(0,v.g6)(),[p,j]=(0,r.useState)(x);(0,r.useEffect)(()=>{if(!h)return;let s=m(h),a=s.filter(s=>s.name.toLowerCase().includes(e.toLowerCase()));j(a)},[e,x,h,m]);let g=u.find(e=>e.id===h);return(0,t.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,t.jsx)(d.$,{}),(0,t.jsxs)("div",{className:"flex-1 space-y-4 p-4 md:p-8 pt-6 pb-20 md:pb-8",children:[(0,t.jsxs)(l.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Workers"}),g&&(0,t.jsxs)("p",{className:"text-muted-foreground",children:["Manage workers for ",g.name]})]}),(0,t.jsxs)(i.z,{onClick:()=>o(!0),disabled:!h,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:[(0,t.jsx)(A.Z,{className:"mr-2 h-4 w-4"})," Add Worker"]})]}),(0,t.jsxs)(l.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3,delay:.1},className:"relative",children:[(0,t.jsx)(T.Z,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(c.I,{placeholder:"Search workers...",className:"pl-8",value:e,onChange:e=>s(e.target.value)})]}),h?0===p.length?(0,t.jsx)(l.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3,delay:.2},className:"flex h-[200px] items-center justify-center rounded-md border border-dashed",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-medium",children:"No workers found"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e?"No workers match your search criteria":"Get started by adding a worker"}),!e&&(0,t.jsxs)(i.z,{variant:"outline",className:"mt-4",onClick:()=>o(!0),children:[(0,t.jsx)(A.Z,{className:"mr-2 h-4 w-4"})," Add Worker"]})]})}):(0,t.jsx)(l.E.div,{variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:(0,t.jsx)(n.M,{children:p.map(e=>(0,t.jsx)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.95},transition:{duration:.3},children:(0,t.jsx)(C,{worker:e})},e.id))})}):(0,t.jsx)(l.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3,delay:.2},className:"flex h-[200px] items-center justify-center rounded-md border border-dashed",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-medium",children:"No firm selected"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Please select a firm to view and manage workers"})]})})]}),(0,t.jsx)(E.T,{open:a,onOpenChange:o})]})}}},function(e){e.O(0,[953,199,278,725,276,691,322,647,5,302,464,971,864,744],function(){return e(e.s=57918)}),_N_E=e.O()}]);